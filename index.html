<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Midjourney Prompt Builder</title>
  <style>
    body {
      margin: 0;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background-color: #f0f0f0;
      color: #333;
      display: flex;
      flex-direction: column;
      min-height: 100vh;
    }

    header {
      background-color: #222;
      color: #fff;
      padding: 1rem;
      text-align: center;
    }

    main {
      display: flex;
      flex: 1;
      padding: 1rem;
    }

    section {
      flex: 3;
      padding-right: 1rem;
    }

    aside {
      flex: 1;
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 0.5rem;
      background: #eaeaea;
      padding: 1rem;
      border-left: 2px solid #ccc;
    }

    .box {
      background: #333;
      color: white;
      padding: 0.5rem;
      border-radius: 8px;
      box-shadow: 0 2px 4px rgba(0,0,0,0.2);
      transition: transform 0.2s, box-shadow 0.2s;
      cursor: pointer;
    }

    .box:hover {
      transform: scale(1.03);
      box-shadow: 0 4px 8px rgba(0,0,0,0.3);
    }

    .box img {
      width: 100%;
      height: auto;
      border-radius: 4px;
    }

    .form-section {
      margin-bottom: 1rem;
    }

    .category-title {
      grid-column: span 2;
      font-weight: bold;
      margin-top: 1rem;
    }

    .active-style {
      border: 2px solid #5dbb63;
    }

    .prompt-output {
      background: white;
      padding: 1rem;
      border-radius: 8px;
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
      margin-top: 1rem;
    }

    .add-category-section {
      background: #ddd;
      padding: 1rem;
      margin-top: 2rem;
      border-radius: 8px;
    }
  </style>
</head>
<body>
  <header>
    <h1>Midjourney Prompt Builder</h1>
  </header>
  <main>
    <section>
      <div class="form-section">
        <input id="boxTitle" placeholder="Title" />
        <input id="boxContent" placeholder="Prompt text" />
        <input id="boxImage" placeholder="Image URL (optional)" />
        <select id="boxCategory">
          <option value="Location">Location</option>
          <option value="Style">Style</option>
          <option value="Look">Look</option>
          <option value="Parameters">Parameters</option>
          <option value="Profiles">Profiles</option>
        </select>
        <button onclick="addBox()">Add Box</button>
      </div>

      <div class="prompt-output">
        <h3>Combined Prompt:</h3>
        <p id="combinedPrompt"></p>
      </div>

      <div class="add-category-section">
        <input id="newCategoryInput" placeholder="New category name" />
        <button onclick="addCategory()">Add Category</button>
      </div>

      <div id="categories"></div>
    </section>
    <aside>
      <div class="category-title">ðŸ‘— Styles</div>
      <div id="Style" class="style-grid"></div>
    </aside>
  </main>
  <script>
    let categories = ["Location", "Style", "Look", "Parameters", "Profiles"];
    let boxes = JSON.parse(localStorage.getItem('boxes') || '[]');
    let activeStyleId = null;

    function addCategory() {
      const name = document.getElementById('newCategoryInput').value.trim();
      if (name && !categories.includes(name)) {
        categories.push(name);
        const option = document.createElement('option');
        option.value = name;
        option.textContent = name;
        document.getElementById('boxCategory').appendChild(option);
        renderCategories();
        document.getElementById('newCategoryInput').value = '';
      }
    }

    function addBox() {
      const title = document.getElementById('boxTitle').value;
      const content = document.getElementById('boxContent').value;
      const image = document.getElementById('boxImage').value;
      const category = document.getElementById('boxCategory').value;

      const box = {
        id: Date.now(),
        title,
        content,
        image,
        category
      };
      boxes.push(box);
      localStorage.setItem('boxes', JSON.stringify(boxes));
      renderBoxes();
      document.getElementById('boxTitle').value = '';
      document.getElementById('boxContent').value = '';
      document.getElementById('boxImage').value = '';
    }

    function renderCategories() {
      const container = document.getElementById('categories');
      container.innerHTML = '';
      categories.forEach(cat => {
        if (cat !== 'Style') {
          const catDiv = document.createElement('div');
          catDiv.innerHTML = `<h3>${cat}</h3><div id="cat-${cat}"></div>`;
          container.appendChild(catDiv);
        }
      });
    }

    function renderBoxes() {
      renderCategories();
      document.querySelectorAll('[id^="cat-"]').forEach(el => el.innerHTML = '');
      document.getElementById('Style').innerHTML = '';
      const promptParts = {
        Location: '', Style: '', Look: '', Parameters: '', Profiles: ''
      };

      boxes.forEach(box => {
        const el = document.createElement('div');
        el.className = 'box';
        if (box.category === 'Style') {
          el.innerHTML = `${box.image ? `<img src="${box.image}" />` : ''}<strong>${box.title}</strong>`;
          if (box.id === activeStyleId) el.classList.add('active-style');
          el.onclick = () => {
            activeStyleId = box.id;
            promptParts.Style = box.content;
            updatePrompt(promptParts);
            renderBoxes();
          };
          document.getElementById('Style').appendChild(el);
        } else {
          el.innerHTML = `<strong>${box.title}</strong><p>${box.content}</p>`;
          el.onclick = () => {
            promptParts[box.category] = promptParts[box.category] + ' ' + box.content;
            updatePrompt(promptParts);
          };
          document.getElementById(`cat-${box.category}`).appendChild(el);
        }
      });
    }

    function updatePrompt(parts) {
      const order = ['Location', 'Style', 'Look', 'Parameters', 'Profiles'];
      document.getElementById('combinedPrompt').textContent = order.map(k => parts[k] || '').join(' ').trim();
    }

    window.onload = () => {
      renderBoxes();
    };
  </script>
</body>
</html>
